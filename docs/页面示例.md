### 示例1

src/pages/my/index.vue

```vue
<route lang="json5" type="page">
{
  style: { navigationBarTitleText: '登录' },
}
</route>

<template>
  <view class="text-center">
    <view class="leading-10">登录成功后会跳转回拦截前的页面</view>
    <view class="p-10">
      <uv-button type="primary" @click="login">登录</uv-button>
    </view>
  </view>
</template>
```

### 示例2

src/pages/my/index.vue

```vue
<route lang="json5">
{
  style: { navigationBarTitleText: '我的' },
}
</route>
<template>
  <view class="ml-4">wx的openid:</view>
  <view class="ml-4">{{ openId }}</view>
  <wx-login />
</template>

<script lang="ts" setup>
import { useUserStore } from '@/store'
import { http } from '@/utils/http'
import WxLogin from './components/wx-login.vue'

const userStore = useUserStore()
const openId = ref('')

// 用户登录，获取openId
uni.login({
  provider: 'weixin',
  success: async ({ code }) => {
    const res = await http<{ session_key: string; openid: string }>({
      method: 'GET',
      url: '/weixin/jscode2session',
      data: {
        code,
      },
    })
    console.log('微信登录-1：', res)
    // {code: 0, msg: "success", data: {session_key: "JTzhLVK+oM3X58uJ/heDcQ==", openid: "oSYa06xPVqjsK-eFYzt0kSPYu1q4"}}
    openId.value = res.data.openid
    userStore.setUserInfo({ openid: res.data.openid })
  },
})
</script>
```

子页面
src/pages/my/components/wx-login.vue

```vue
<route lang="json5">
{
  style: { navigationBarTitleText: '登录' },
}
</route>

<template>
  <view class="p-4">
    <view class="flex items-center leading-6" v-if="hasLogin">
      <image class="w-8 h-8 rounded-full" :src="userStore.userInfo?.avatar"></image>
      <view class="ml-2">{{ userStore.userInfo?.nickname }}</view>
    </view>
    <view class="flex items-center leading-6" v-else @click="show = true">
      <view class="i-carbon-user-avatar"></view>
      <view class="ml-2">点击显示微信头像</view>
    </view>
    <fly-login v-model="show" />
    <fly-content :line="10" />
    <button v-if="hasLogin" class="mt-2" @click="logout">退出登录</button>
  </view>
</template>

<script lang="ts" setup name="WxLogin">
import { useUserStore } from '@/store'

const show = ref(false)
const userStore = useUserStore()
const hasLogin = computed(() => userStore.userInfo?.nickname)
const logout = () => {
  uni.showModal({
    title: '确认退出当前账号？',
    success: (res) => {
      if (res.confirm) {
        userStore.clearUserInfo()
      }
    },
  })
}
</script>
```
